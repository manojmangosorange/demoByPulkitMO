import{j as e}from"./chunk-aAkv6woa.js";import{r as s}from"./chunk-CRvknJha.js";import{C as a,a as t,b as l,B as r,c as i,T as n,J as c,I as d}from"../assets/index-BdECdtOY.js";import{S as o,a as m,b as x,c as h,d as p}from"./chunk-D1gP0dpu.js";import{A as u}from"./chunk-D8XlI3mD.js";import{B as j}from"./chunk-DGs3gSCA.js";import{c as v}from"./chunk-BjzA4HJ1.js";import{g,P as f,az as N,a4 as b,ah as w,aA as y,X as S,a0 as A,U as k}from"./chunk-CwPyCuk6.js";import"./chunk-DbexCMFd.js";import"./chunk-DdJ5UvfL.js";import"./chunk-Djsr9rkS.js";import"./chunk-KSTQTUbB.js";const C=({applicant:d,onUpdate:u,jobTitle:A})=>{const[k,C]=s.useState(!1),[L,U]=s.useState(d.status),[I,R]=s.useState(d.notes||""),[$,D]=s.useState(!1);return e.jsxs(a,{className:"hover:shadow-md transition-shadow",children:[e.jsx(t,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-lg",children:d.name}),A&&e.jsx(j,{variant:"secondary",className:"mt-2 mb-1",children:A}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4"}),e.jsx("a",{href:`mailto:${d.email}`,className:"hover:text-primary",children:d.email})]}),d.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("a",{href:`tel:${d.phone}`,className:"hover:text-primary",children:d.phone})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:(e=>{switch(e){case"Applied":return"bg-blue-100 text-blue-800";case"Shortlisted":return"bg-yellow-100 text-yellow-800";case"Interviewed":return"bg-purple-100 text-purple-800";case"Hired":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(d.status),children:d.status}),!k&&e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>C(!0),children:e.jsx(N,{className:"w-4 h-4"})})]})]})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"w-4 h-4"}),"Applied: ",new Date(d.appliedAt).toLocaleDateString()]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>window.open(d.resumeUrl,"_blank"),children:[e.jsx(w,{className:"w-4 h-4 mr-1"}),"Resume"]})]}),d.coverLetter&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-foreground mb-1",children:"Cover Letter:"}),e.jsx("div",{className:"text-sm text-gray-800 bg-muted/50 p-3 rounded-lg",children:d.coverLetter})]}),k?e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Status"}),e.jsxs(o,{value:L,onValueChange:e=>U(e),children:[e.jsx(m,{children:e.jsx(x,{})}),e.jsxs(h,{children:[e.jsx(p,{value:"Applied",children:"Applied"}),e.jsx(p,{value:"Shortlisted",children:"Shortlisted"}),e.jsx(p,{value:"Interviewed",children:"Interviewed"}),e.jsx(p,{value:"Hired",children:"Hired"}),e.jsx(p,{value:"Rejected",children:"Rejected"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Notes"}),e.jsx(n,{value:I,onChange:e=>R(e.target.value),placeholder:"Add notes about this applicant...",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{onClick:async()=>{D(!0);try{await v.updateApplicantStatus(d.id,L,I)?(c.success("Applicant updated successfully"),C(!1),u()):c.error("Failed to update applicant")}catch(e){c.error("An error occurred")}finally{D(!1)}},disabled:$,size:"sm",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),$?"Saving...":"Save"]}),e.jsxs(r,{variant:"outline",onClick:()=>{U(d.status),R(d.notes||""),C(!1)},size:"sm",children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Cancel"]})]})]}):d.notes&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("div",{className:"text-sm font-medium text-foreground mb-1",children:"Notes:"}),e.jsx("div",{className:"text-sm text-gray-800 bg-muted/50 p-3 rounded-lg",children:d.notes})]})]})]})},L=()=>{const[t,l]=s.useState([]),[n,j]=s.useState([]),[g,f]=s.useState(!0),[N,b]=s.useState(""),[y,S]=s.useState("all"),[L,U]=s.useState("all");s.useEffect(()=>{I()},[]);const I=async()=>{try{const[e,s]=await Promise.all([v.getApplicants(),v.getJobPostings(!0)]);l(e),j(s)}catch(e){c.error("Failed to load applicants")}finally{f(!1)}},R=t.filter(e=>{const s=e.name?.toLowerCase().includes(N.toLowerCase())||e.email?.toLowerCase().includes(N.toLowerCase()),a="all"===y||e.status===y,t="all"===L||e.jobId===L;return s&&a&&t});return g?e.jsx(u,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsx(u,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Applicants"}),e.jsx("p",{className:"text-gray-800",children:"Manage job applications and candidate pipeline"})]}),e.jsx(a,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-800"}),e.jsx(d,{placeholder:"Search applicants...",value:N,onChange:e=>b(e.target.value),className:"pl-10"})]}),e.jsxs(o,{value:y,onValueChange:S,children:[e.jsx(m,{className:"w-full lg:w-48",children:e.jsx(x,{placeholder:"Filter by status"})}),e.jsxs(h,{children:[e.jsx(p,{value:"all",children:"All Status"}),e.jsx(p,{value:"Applied",children:"Applied"}),e.jsx(p,{value:"Shortlisted",children:"Shortlisted"}),e.jsx(p,{value:"Interviewed",children:"Interviewed"}),e.jsx(p,{value:"Hired",children:"Hired"}),e.jsx(p,{value:"Rejected",children:"Rejected"})]})]}),e.jsxs(o,{value:L,onValueChange:U,children:[e.jsx(m,{className:"w-full lg:w-64",children:e.jsx(x,{placeholder:"Filter by job"})}),e.jsxs(h,{children:[e.jsx(p,{value:"all",children:"All Jobs"}),n.map(s=>e.jsx(p,{value:s.id,children:s.title},s.id))]})]})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(r,{onClick:()=>{if(0===R.length)return void c.error("No applicants to export");const e=[["Name","Email","Phone","Status","Job Applied For","Application Date","Resume URL","Cover Letter","Notes"],...R.map(e=>{const s=n.find(s=>s.id===e.jobId);return[e.name||"",e.email||"",e.phone||"",e.status||"",s?.title||"Unknown Position",new Date(e.appliedAt).toLocaleDateString()||"",e.resumeUrl||"",e.coverLetter||"",e.notes||""]})].map(e=>e.map(e=>`"${e.replace(/"/g,'""')}"`).join(",")).join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){const e=URL.createObjectURL(s);a.setAttribute("href",e),a.setAttribute("download",(()=>{const e=(new Date).toISOString().split("T")[0],s=n.find(e=>e.id===L);let a="All";return"all"!==y&&"all"!==L?a=`${y}_${s?.title?.replace(/\s+/g,"")||"Unknown"}`:"all"!==y?a=y:"all"!==L?a=s?.title?.replace(/\s+/g,"")||"Unknown":N&&(a="Filtered"),`Applicants_${a}_${e}.csv`})()),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),c.success(`Exported ${R.length} applicants to CSV`)}},variant:"outline",className:"gap-2",disabled:0===R.length,children:[e.jsx(w,{className:"w-4 h-4"}),"Download CSV (",R.length,")"]})}),0===R.length?e.jsx(a,{children:e.jsxs(i,{className:"p-12 text-center",children:[e.jsx(k,{className:"w-12 h-12 text-gray-800 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No applicants found"}),e.jsx("p",{className:"text-gray-800",children:N||"all"!==y||"all"!==L?"Try adjusting your search or filters":"Applications will appear here when candidates apply for your job postings"})]})}):e.jsx("div",{className:"grid gap-6",children:R.map(s=>{const a=n.find(e=>e.id===s.jobId);return e.jsx(C,{applicant:s,onUpdate:I,jobTitle:a?.title},s.id)})})]})})};export{L as default};
