const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BdECdtOY.js","js/chunk-aAkv6woa.js","js/chunk-CRvknJha.js","js/chunk-DbexCMFd.js","js/chunk-DdJ5UvfL.js","js/chunk-CwPyCuk6.js","js/chunk-Djsr9rkS.js","js/chunk-KSTQTUbB.js","css/index-C4KhPFnt.css"])))=>i.map(i=>d[i]);
import{_ as e}from"./chunk-DbexCMFd.js";import{j as s}from"./chunk-aAkv6woa.js";import{r as a}from"./chunk-CRvknJha.js";import{o as r,s as t,f as c,i,t as n,J as l,B as d,j as o,k as m,l as h,m as u,n as x,I as j,p,C as f,c as w,r as N}from"../assets/index-BdECdtOY.js";import{B as y}from"./chunk-DGs3gSCA.js";import{T as g,c as v}from"./chunk-DNG7ZfCr.js";import{D as b,d as k,a as C,b as _,c as P,e as S}from"./chunk-DytPa1i8.js";import{A}from"./chunk-D8XlI3mD.js";import{y as E,a1 as R,av as D,E as F,U as z,aw as I,ax as O}from"./chunk-CwPyCuk6.js";import"./chunk-DdJ5UvfL.js";import"./chunk-Djsr9rkS.js";import"./chunk-KSTQTUbB.js";const T=r({name:t().min(1,"Please enter the name"),email:t().email("Please enter a valid email"),password:t().min(6,"Password must be at least 6 characters")}),V=()=>{const[r,t]=a.useState([]),[V,$]=a.useState(!1),[q,B]=a.useState(!1),[L,U]=a.useState(!1),[J,M]=a.useState({}),[Z,G]=a.useState({}),H=c({resolver:i(T),defaultValues:{name:"",email:"",password:""}});a.useEffect(()=>{K()},[]);const K=async()=>{try{const{data:e,error:s}=await n.from("admin_users").select("id, email, name, role, created_at, password_hash").order("created_at",{ascending:!1});if(s)throw s;t(e||[])}catch(e){l.error("Failed to load recruiters")}};return s.jsx(A,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Dashboard"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage recruiter accounts and oversee the career system"})]}),s.jsxs(y,{variant:"secondary",className:"text-sm",children:[s.jsx(E,{className:"w-4 h-4 mr-1"}),"Administrator"]})]}),s.jsx(g,{defaultValue:"recruiters",className:"space-y-6",children:s.jsxs(v,{value:"recruiters",className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Recruiter Accounts"}),s.jsxs(b,{open:q,onOpenChange:B,children:[s.jsx(k,{asChild:!0,children:s.jsxs(d,{className:"flex items-center gap-2",children:[s.jsx(R,{className:"w-4 h-4"}),"Create Recruiter"]})}),s.jsxs(C,{children:[s.jsxs(_,{children:[s.jsx(P,{children:"Create New Recruiter Account"}),s.jsx(S,{children:"Create a new recruiter account with limited permissions"})]}),s.jsx(o,{...H,children:s.jsxs("form",{onSubmit:H.handleSubmit(async e=>{$(!0);try{const s=await N.signUp(e.email,e.password,"Recruiter",e.name);s?(G(a=>({...a,[s.id]:e.password})),l.success("Recruiter account created successfully!"),B(!1),H.reset(),K()):l.error("Failed to create recruiter account")}catch(s){l.error("Failed to create recruiter account")}finally{$(!1)}}),className:"space-y-4",children:[s.jsx(m,{control:H.control,name:"name",render:({field:e})=>s.jsxs(h,{children:[s.jsx(u,{children:"Full Name"}),s.jsx(x,{children:s.jsx(j,{placeholder:"Enter full name",...e})}),s.jsx(p,{})]})}),s.jsx(m,{control:H.control,name:"email",render:({field:e})=>s.jsxs(h,{children:[s.jsx(u,{children:"Email"}),s.jsx(x,{children:s.jsx(j,{placeholder:"Enter email address",...e})}),s.jsx(p,{})]})}),s.jsx(m,{control:H.control,name:"password",render:({field:e})=>s.jsxs(h,{children:[s.jsx(u,{children:"Password"}),s.jsx(x,{children:s.jsxs("div",{className:"relative",children:[s.jsx(j,{type:L?"text":"password",placeholder:"Enter password",...e}),s.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>U(!L),children:L?s.jsx(D,{className:"h-4 w-4"}):s.jsx(F,{className:"h-4 w-4"})})]})}),s.jsx(p,{})]})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(d,{type:"button",variant:"outline",onClick:()=>B(!1),children:"Cancel"}),s.jsx(d,{type:"submit",disabled:V,children:V?"Creating...":"Create Account"})]})]})})]})]})]}),s.jsx("div",{className:"grid gap-4",children:r.map(a=>s.jsxs(f,{children:[s.jsxs(w,{className:"flex items-center justify-between p-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:s.jsx(z,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:a.name||"No Name"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:a.email}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(y,{variant:"Admin"===a.role?"default":"secondary",children:a.role}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:["Created ",new Date(a.created_at).toLocaleDateString()]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(d,{variant:"outline",size:"sm",onClick:()=>(async(s,a)=>{const r=prompt(`Enter new password for ${a}:`);if(!r||r.length<6)l.error("Password must be at least 6 characters");else try{const a=await e(()=>import("../assets/index-BdECdtOY.js").then(e=>e.z),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),t=await a.hash(r,10),{error:c}=await n.from("admin_users").update({password_hash:t,updated_at:(new Date).toISOString()}).eq("id",s);if(c)throw c;G(e=>({...e,[s]:r})),l.success("Password reset successfully!"),K()}catch(t){l.error("Failed to reset password")}})(a.id,a.email),className:"flex items-center gap-1",children:[s.jsx(I,{className:"w-4 h-4"}),"Reset Password"]}),"Admin"!==a.role&&s.jsxs(d,{variant:"destructive",size:"sm",onClick:()=>(async(e,s)=>{if(confirm(`Are you sure you want to delete the recruiter account for ${s}?`))try{const{error:s}=await n.from("admin_users").delete().eq("id",e);if(s)throw s;l.success("Recruiter account deleted successfully"),K()}catch(a){l.error("Failed to delete recruiter account")}})(a.id,a.email),className:"flex items-center gap-1",children:[s.jsx(O,{className:"w-4 h-4"}),"Delete"]})]})]}),J[a.id]&&s.jsx(w,{className:"pt-0",children:s.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Current Password:"}),s.jsx("p",{className:"text-sm font-mono bg-background px-2 py-1 rounded border",children:Z[a.id]||"Password is encrypted - use Reset Password to set a new one"}),Z[a.id]&&s.jsx("p",{className:"text-xs text-green-600 mt-1",children:"âœ“ This password was recently set and is temporarily visible"})]})})]},a.id))})]})})]})})};export{V as default};
